<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>票据详情 - PDF预览</title>
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #f2f2f2;
    }
    /* 顶部工具栏 */
    .toolbar {
        display: flex;
        align-items: center;
        background-color: #f5f5f5;
        border-bottom: 1px solid #ddd;
        padding: 8px;
        font-size: 14px;
    }
    .toolbar-left,
    .toolbar-right {
        display: flex;
        align-items: center;
    }
    .toolbar-left {
        flex: 1;
    }
    .btn {
        background: none;
        border: none;
        font-size: 18px;
        padding: 4px 8px;
        cursor: pointer;
    }
    .title {
        font-weight: bold;
        margin: 0 8px;
    }
    .url {
        color: #666;
        font-size: 12px;
    }
    /* 中间控制区 */
    .toolbar-center {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    .page-indicator {
        background: white;
        border: 1px solid #ccc;
        border-radius: 4px;
        padding: 2px 6px;
        font-size: 12px;
    }
    /* 图标模拟 */
    .icon {
        font-size: 18px;
        padding: 4px;
        cursor: pointer;
    }
    #pdf-viewer {
        height: calc(100vh - 48px);
        overflow: auto;
        background: white;
        text-align: center;
    }
</style>
</head>
<body>

<div class="toolbar">
    <!-- 左侧 -->
    <div class="toolbar-left">
        <button class="btn" onclick="window.history.back()">✖</button>
        <div>
            <div class="title">票据详情</div>
            <div class="url">example.com</div>
        </div>
    </div>

    <!-- 中间 -->
    <div class="toolbar-center">
        <span class="icon" onclick="searchPDF()">🔍</span>
        <span class="page-indicator" id="page-info">1 / ?</span>
        <span class="icon" onclick="zoomOut()">➖</span>
        <span class="icon" onclick="zoomIn()">➕</span>
        <span class="icon" onclick="nextPage()">⏩</span>
    </div>

    <!-- 右侧 -->
    <div class="toolbar-right">
        <span class="icon">⋮</span>
    </div>
</div>

<div id="pdf-viewer">
    <canvas id="pdf-canvas"></canvas>
</div>

<!-- 引入 PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>
<script>
    const url = "document.pdf"; // 本地PDF文件路径

    let pdfDoc = null,
        pageNum = 1,
        pageRendering = false,
        pageNumPending = null,
        scale = 1.0,
        canvas = document.getElementById('pdf-canvas'),
        ctx = canvas.getContext('2d');

    pdfjsLib.getDocument(url).promise.then(function (pdf) {
        pdfDoc = pdf;
        document.getElementById('page-info').textContent = pageNum + " / " + pdfDoc.numPages;
        renderPage(pageNum);
    });

    function renderPage(num) {
        pageRendering = true;
        pdfDoc.getPage(num).then(function (page) {
            let viewport = page.getViewport({ scale: scale });
            canvas.height = viewport.height;
            canvas.width = viewport.width;

            let renderContext = {
                canvasContext: ctx,
                viewport: viewport
            };
            let renderTask = page.render(renderContext);

            renderTask.promise.then(function () {
                pageRendering = false;
                document.getElementById('page-info').textContent = num + " / " + pdfDoc.numPages;
                if (pageNumPending !== null) {
                    renderPage(pageNumPending);
                    pageNumPending = null;
                }
            });
        });
    }

    function queueRenderPage(num) {
        if (pageRendering) {
            pageNumPending = num;
        } else {
            renderPage(num);
        }
    }

    function nextPage() {
        if (pageNum >= pdfDoc.numPages) return;
        pageNum++;
        queueRenderPage(pageNum);
    }

    function zoomIn() {
        scale += 0.1;
        queueRenderPage(pageNum);
    }

    function zoomOut() {
        if (scale > 0.2) {
            scale -= 0.1;
            queueRenderPage(pageNum);
        }
    }

    function searchPDF() {
        alert("这里可以实现搜索功能");
    }
</script>

</body>
</html>
